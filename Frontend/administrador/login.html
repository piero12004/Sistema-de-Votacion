<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo - Iniciar Sesi칩n</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-custom-blue-bg min-h-screen flex items-center justify-center p-4">
    <div class="bg-white p-10 md:p-12 rounded-3xl shadow-2xl max-w-md w-full">
        <!-- T칤tulo -->
        <h1 class="text-xl md:text-2xl font-serif text-custom-dark-button text-center mb-8">
            Panel Administrativo
        </h1>

        <!-- Formulario de Login -->
        <form id="formLogin">

            <div class="mb-6">
                <label for="usuario" class="block text-md mb-2 text-gray-700">Usuario:</label>
                <input type="email" id="usuario" name="usuario" placeholder="User@example.com"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-custom-blue-bg"
                    required>
            </div>

            <div class="mb-8">
                <label for="contrasena" class="block text-md mb-2 text-gray-700">Contrase침a:</label>
                <input type="password" id="contrasena" name="contrasena" placeholder="**********"
                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-custom-blue-bg"
                    required>
            </div>

            <div class="flex justify-center">
                <button type="submit"
                    class="bg-custom-dark-button text-white text-lg font-semibold py-2 px-8 rounded-lg shadow-lg hover:bg-opacity-90 transition duration-300">
                    Ingresar
                </button>
            </div>

        </form>

        <p class="text-center text-xs text-custom-text-footer mt-10">
            춸 2025 Grupo 3 - Administrador
        </p>
    </div>

    <!--Estilos del logins-->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'custom-blue-bg': '#5c79a6',
                        'custom-dark-button': '#355b63',
                        'custom-text-footer': '#5a5a5a',
                    }
                }
            }
        }
    </script>

    <!-- 游댠 SCRIPT PARA CONECTAR CON BACKEND -->
    <script>
        const form = document.getElementById("formLogin");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            const usuario = document.getElementById("usuario").value;
            const contrase침a = document.getElementById("contrasena").value;

            try {
                const res = await fetch("https://sistema-de-votacion-gjzq.onrender.com/api/admin/login", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ usuario, password: contrase침a })

                });

                const data = await res.json();

                if (!res.ok) {
                    alert(data.message || "Credenciales incorrectas");
                    return;
                }

                localStorage.setItem("tokenAdmin", data.token);
                localStorage.setItem("adminUsuario", data.admin.usuario.split("@")[0]);

                window.location.href = "principal.html";

            } catch (error) {
                alert("Error al conectar con el servidor");
                console.error(error);
            }
        });
    </script>


</body>

</html>